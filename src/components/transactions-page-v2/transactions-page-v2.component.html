<div class="min-h-screen bg-gray-50 p-2 sm:p-4 lg:p-6">
  <main class="flex flex-col bg-white rounded-xl shadow-sm border border-gray-200/50 max-w-[1800px] w-full mx-auto h-[calc(100vh-1rem)] sm:h-[calc(100vh-2rem)] lg:h-[calc(100vh-3rem)] !overflow-visible">
    <!-- Top Navigation -->
    <div class="flex items-center justify-between p-4 sm:p-6 pb-2 border-b border-gray-100">
      <div class="flex items-baseline gap-x-3 sm:gap-x-4 flex-wrap">
        <a routerLink="/wealth" class="text-xl sm:text-2xl font-medium text-gray-400 hover:text-gray-600 transition-colors">
          Wealth
        </a>
        <h1 class="text-2xl sm:text-3xl font-bold tracking-tight text-gray-900">
          Transactions
        </h1>
      </div>
      <app-user-profile></app-user-profile>
    </div>
    
    <div class="flex-1 flex flex-col !overflow-visible min-h-0">

  <!-- Mobile Tab Navigation (visible on small screens) -->
  <div class="sm:hidden flex-shrink-0 border-b border-gray-100 px-4 py-2 bg-white">
    <div class="flex gap-2">
      <button 
        (click)="setActiveView('transactions')"
        class="flex-1 py-2 px-3 rounded-lg text-xs font-medium transition-all"
        [class]="activeView() === 'transactions' 
          ? 'bg-gray-900 text-white' 
          : 'bg-gray-100 text-gray-600'">
        Historical
      </button>
      <button 
        (click)="setActiveView('recurring')"
        class="flex-1 py-2 px-3 rounded-lg text-xs font-medium transition-all"
        [class]="activeView() === 'recurring' 
          ? 'bg-gray-900 text-white' 
          : 'bg-gray-100 text-gray-600'">
        Recurring
      </button>
      <button 
        (click)="setActiveView('planning')"
        class="flex-1 py-2 px-3 rounded-lg text-xs font-medium transition-all"
        [class]="activeView() === 'planning' 
          ? 'bg-gray-900 text-white' 
          : 'bg-gray-100 text-gray-600'">
        Planning
      </button>
    </div>
  </div>

  <!-- Main Content Area: Centered Sidebar + Content -->
  <div class="flex-1 flex justify-center min-h-0 !overflow-visible">
    <div class="flex w-full h-full !overflow-visible">
      <!-- Vertical Sidebar Navigation -->
      <nav class="flex-shrink-0 w-52 py-6 pr-6 hidden sm:block">
        <ul class="space-y-1">
          <li>
            <button 
              (click)="setActiveView('transactions')"
              class="w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-all duration-200"
              [class]="activeView() === 'transactions' 
                ? 'bg-gray-900 text-white' 
                : 'text-gray-600 hover:bg-gray-100 hover:text-gray-900'">
              Historical Transactions
            </button>
          </li>
          <li>
            <button 
              (click)="setActiveView('recurring')"
              class="w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-all duration-200"
              [class]="activeView() === 'recurring' 
                ? 'bg-gray-900 text-white' 
                : 'text-gray-600 hover:bg-gray-100 hover:text-gray-900'">
              Recurring Investments
            </button>
          </li>
          <li>
            <button 
              (click)="setActiveView('planning')"
              class="w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-all duration-200"
              [class]="activeView() === 'planning' 
                ? 'bg-gray-900 text-white' 
                : 'text-gray-600 hover:bg-gray-100 hover:text-gray-900'">
              Planning
            </button>
          </li>
        </ul>
      </nav>

      <!-- Content Area -->
      <div class="flex-1 min-h-0 flex flex-col border-l border-gray-100 sm:border-l !overflow-visible">
        <div class="flex-1 min-h-0 !overflow-visible">
        @if (activeView() === 'transactions') {
          <!-- Historical Transactions View -->
          @if (isLoading() && !isAddingTransaction()) {
            <app-transaction-skeleton></app-transaction-skeleton>
          } @else if (error() && transactions().length === 0) {
            <app-error-state
              [title]="'Unable to load transactions'"
              [message]="error() || 'We couldn\'t connect to Alfred. Please check your connection.'"
              (retry)="transactionService.reload()">
            </app-error-state>
          } @else {
            <app-transaction-list 
              [transactions]="filteredTransactions()" 
              [searchQuery]="searchQuery()"
              (searchQueryChange)="onSearchChange($event)"
              [isAdding]="isAddingTransaction()"
              [isLoading]="isLoading()"
              [error]="error()"
              [totalInvested]="filteredTotalInvested()"
              (save)="saveTransaction($event)"
              (cancel)="cancelNewTransaction()"
              (update)="updateTransaction($event)"
              (delete)="deleteTransaction($event)"
              (toggleAdd)="toggleAddTransaction()"
              (navigateToRecurring)="navigateToRecurring()"
              [cashBalance]="cashBalance()"
              (updateCash)="updateCashBalance($event)">
            </app-transaction-list>
          }
        } @else if (activeView() === 'recurring') {
          <!-- Recurring Investments View -->
          <app-recurring-investments-list
            (navigateToTransactions)="navigateToTransactions()">
          </app-recurring-investments-list>
        } @else if (activeView() === 'planning') {
          <!-- Planning View -->
          <app-planning></app-planning>
        }
        </div>
      </div>
    </div>
  </div>
</div>
  </main>
</div>
